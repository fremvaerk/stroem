server:
  image:
    repository: stroem-server
    tag: latest
  replicas: 1
  service:
    type: ClusterIP
    port: 8080
  config:
    logStorageDir: /var/stroem/logs
    # Workspaces map matching server-config.yaml format
    workspaces:
      default:
        type: folder
        path: /workspace
  resources: {}

worker:
  image:
    repository: stroem-worker
    tag: latest
  replicas: 2
  config:
    maxConcurrent: 4
    pollIntervalSecs: 2
    workspaceCacheDir: /var/stroem/workspace-cache
    capabilities: ["shell"]
  # Docker-in-Docker sidecar for DockerRunner
  dind:
    enabled: false
    image: docker:27-dind
    resources: {}
  # KubeRunner configuration
  kubernetes:
    enabled: false
    namespace: stroem-jobs
    initImage: curlimages/curl:latest
  resources: {}

# Shared auth token between server and workers
workerToken: "change-me-in-production"

# Authentication (optional)
auth:
  enabled: false
  jwtSecret: ""
  refreshSecret: ""
  # Base URL for OIDC redirect URIs (e.g. https://stroem.example.com)
  baseUrl: ""
  # Initial admin user (created on first deploy)
  initialUser:
    username: admin
    password: ""
  # OIDC providers
  providers: []
  #  - name: google
  #    displayName: Google
  #    providerType: oidc
  #    issuerUrl: https://accounts.google.com
  #    clientId: ""
  #    clientSecret: ""

# External PostgreSQL (required)
database:
  url: "postgres://stroem:stroem@postgres:5432/stroem"

# RBAC for pod creation (needed for KubeRunner)
rbac:
  create: true

serviceAccount:
  create: true
  name: ""

# Optional Ingress for UI and webhook triggers
ingress:
  enabled: false
  className: ""
  annotations: {}
  hosts:
    - host: stroem.example.com
      paths:
        - path: /
          pathType: Prefix
  tls: []
  #  - secretName: stroem-tls
  #    hosts:
  #      - stroem.example.com
